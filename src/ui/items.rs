use crate::memory::constants::CharData2;
use crate::memory::constants::{self, LevelUp};
use crate::memory::offsets::{self, BONFIRE_WARP, BONFIRE_WARP_2_OFFSET1};
use crate::memory::{Ds1, ds1};
use mem_rs::prelude::*;
use std::alloc::{Layout, alloc, dealloc};
use std::arch::asm;
use std::mem;
type ItemFunc = extern "system" fn(i32, i32, i32, i32, i8, i8);
pub struct Items;

// Infusion data: (name, id_offset, max_upgrade_level, is_special)
const INFUSION_DATA: &[(&str, i32, i32, bool)] = &[
    ("Normal", 0, 15, false),
    ("Chaos", 900, 5, true),
    ("Crystal", 100, 5, false),
    ("Divine", 600, 10, false),
    ("Enchanted", 500, 5, true),
    ("Fire", 800, 10, false),
    ("Lightning", 200, 5, false),
    ("Magic", 400, 10, false),
    ("Occult", 700, 5, true),
    ("Raw", 300, 5, true),
];

const RING_DATA: &[(i32, i32, i32, &str)] = &[
    (100, 1, 0, "Havel's Ring"),
    (101, 1, 0, "Red Tearstone Ring"),
    (102, 1, 0, "Darkmoon Blade Covenant Ring"),
    (103, 1, 0, "Cat Covenant Ring"),
    (104, 1, 0, "Cloranthy Ring"),
    (105, 1, 0, "Flame Stoneplate Ring"),
    (106, 1, 0, "Thunder Stoneplate Ring"),
    (107, 1, 0, "Spell Stoneplate Ring"),
    (108, 1, 0, "Speckled Stoneplate Ring"),
    (109, 1, 0, "Bloodbite Ring"),
    (110, 1, 0, "Poisonbite Ring"),
    (111, 1, 0, "Tiny Being's Ring"),
    (113, 1, 0, "Cursebite Ring"),
    (114, 1, 0, "White Seance Ring"),
    (115, 1, 0, "Bellowing Dragoncrest Ring"),
    (116, 1, 0, "Dusk Crown Ring"),
    (117, 1, 0, "Hornet Ring"),
    (119, 1, 0, "Hawk Ring"),
    (120, 1, 0, "Ring of Steel Protection"),
    (121, 1, 0, "Covetous Gold Serpent Ring"),
    (122, 1, 0, "Covetous Silver Serpent Ring"),
    (123, 1, 0, "Slumbering Dragoncrest Ring"),
    (124, 1, 0, "Ring of Fog"),
    (125, 1, 0, "Rusted Iron Ring"),
    (126, 1, 0, "Ring of Sacrifice"),
    (127, 1, 0, "Rare Ring of Sacrifice"),
    (128, 1, 0, "Dark Wood Grain Ring"),
    (130, 1, 0, "Ring of the Sun Princess"),
    (137, 1, 0, "Old Witch's Ring"),
    (138, 1, 0, "Covenant of Artorias"),
    (139, 1, 0, "Orange Charred Ring"),
    (141, 1, 0, "Lingering Dragoncrest Ring"),
    (142, 1, 0, "Ring of the Evil Eye"),
    (143, 1, 0, "Ring of Favor and Protection"),
    (144, 1, 0, "Leo Ring"),
    (145, 1, 0, "East Wood Grain Ring"),
    (146, 1, 0, "Wolf Ring"),
    (147, 1, 0, "Blue Tearstone Ring"),
    (148, 1, 0, "Ring of the Sun's Firstborn"),
    (149, 1, 0, "Darkmoon Seance Ring"),
    (150, 1, 0, "Calamity Ring"),
];

const WEAPON_DATA: &[(i32, i32, i32, &str)] = &[
    (100000, 1, 3, "Dagger"),
    (101000, 1, 3, "Parrying Dagger"),
    (102000, 1, 1, "Ghost Blade"),
    (103000, 1, 3, "Bandit's Knife"),
    (104000, 1, 1, "Priscilla's Dagger"),
    (200000, 1, 3, "Shortsword"),
    (201000, 1, 3, "Longsword"),
    (202000, 1, 3, "Broadsword"),
    (203000, 1, 3, "Broken Straight Sword"),
    (204000, 1, 3, "Balder Side Sword"),
    (205000, 1, 0, "Crystal Straight Sword"),
    (206000, 1, 3, "Sunlight Straight Sword"),
    (207000, 1, 3, "Barbed Straight Sword"),
    (208000, 1, 1, "Silver Knight Straight Sword"),
    (209000, 1, 1, "Astora's Straight Sword"),
    (210000, 1, 3, "Darksword"),
    (211000, 1, 1, "Drake Sword"),
    (212000, 1, 3, "Straight Sword Hilt"),
    (300000, 1, 3, "Bastard Sword"),
    (301000, 1, 3, "Claymore"),
    (302000, 1, 3, "Man-serpent Greatsword"),
    (303000, 1, 3, "Flamberge"),
    (304000, 1, 0, "Crystal Greatsword"),
    (306000, 1, 1, "Stone Greatsword"),
    (307000, 1, 1, "Greatsword of Artorias"),
    (309000, 1, 1, "Moonlight Greatsword"),
    (310000, 1, 1, "Black Knight Sword"),
    (311000, 1, 1, "Greatsword of Artorias (Cursed)"),
    (314000, 1, 1, "Great Lord Greatsword"),
    (350000, 1, 3, "Zweihander"),
    (351000, 1, 3, "Greatsword"),
    (352000, 1, 3, "Demon Great Machete"),
    (354000, 1, 1, "Dragon Greatsword"),
    (355000, 1, 1, "Black Knight Greatsword"),
    (400000, 1, 3, "Scimitar"),
    (401000, 1, 3, "Falchion"),
    (402000, 1, 3, "Shotel"),
    (403000, 1, 1, "Jagged Ghost Blade"),
    (405000, 1, 3, "Painting Guardian Sword"),
    (406000, 1, 1, "Quelaag's Furysword"),
    (450000, 1, 3, "Server"),
    (451000, 1, 3, "Murakumo"),
    (453000, 1, 1, "Gravelord Sword"),
    (500000, 1, 3, "Uchigatana"),
    (501000, 1, 3, "Washing Pole"),
    (502000, 1, 3, "Iaito"),
    (503000, 1, 1, "Chaos Blade"),
    (600000, 1, 3, "Mail Breaker"),
    (601000, 1, 3, "Rapier"),
    (602000, 1, 3, "Estoc"),
    (603000, 1, 1, "Velka's Rapier"),
    (604000, 1, 3, "Ricard's Rapier"),
    (700000, 1, 3, "Hand Axe"),
    (701000, 1, 3, "Battle Axe"),
    (702000, 1, 1, "Crescent Axe"),
    (703000, 1, 3, "Butcher Knife"),
    (704000, 1, 1, "Golem Axe"),
    (705000, 1, 3, "Gargoyle Tail Axe"),
    (750000, 1, 3, "Greataxe"),
    (751000, 1, 3, "Demon's Greataxe"),
    (752000, 1, 1, "Dragon King Greataxe"),
    (753000, 1, 1, "Black Knight Greataxe"),
    (800000, 1, 3, "Club"),
    (801000, 1, 3, "Mace"),
    (802000, 1, 3, "Morning Star"),
    (803000, 1, 3, "Warpick"),
    (804000, 1, 3, "Pickaxe"),
    (809000, 1, 3, "Reinforced Club"),
    (810000, 1, 3, "Blacksmith Hammer"),
    (811000, 1, 1, "Blacksmith Giant Hammer"),
    (812000, 1, 1, "Hammer of Vamos"),
    (850000, 1, 3, "Great Club"),
    (851000, 1, 1, "Grant"),
    (852000, 1, 3, "Demon's Great Hammer"),
    (854000, 1, 1, "Dragon Tooth"),
    (855000, 1, 3, "Large Club"),
    (856000, 1, 1, "Smough's Hammer"),
    (901000, 1, 3, "Caestus"),
    (902000, 1, 3, "Claw"),
    (903000, 1, 1, "Dragon Bone Fist"),
    (904000, 1, 0, "Dark Hand"),
    (1000000, 1, 3, "Spear"),
    (1001000, 1, 3, "Winged Spear"),
    (1002000, 1, 3, "Partizan"),
    (1003000, 1, 1, "Demon's Spear"),
    (1004000, 1, 1, "Channeler's Trident"),
    (1006000, 1, 1, "Silver Knight Spear"),
    (1050000, 1, 3, "Pike"),
    (1051000, 1, 1, "Dragonslayer Spear"),
    (1052000, 1, 1, "Moonlight Butterfly Horn"),
    (1100000, 1, 3, "Halberd"),
    (1101000, 1, 1, "Giant's Halberd"),
    (1102000, 1, 1, "Titanite Catch Pole"),
    (1103000, 1, 3, "Gargoyle's Halberd"),
    (1105000, 1, 1, "Black Knight Halberd"),
    (1106000, 1, 3, "Lucerne"),
    (1107000, 1, 3, "Scythe"),
    (1150000, 1, 3, "Great Scythe"),
    (1151000, 1, 1, "Lifehunt Scythe"),
    (1200000, 1, 3, "Short Bow"),
    (1201000, 1, 3, "Longbow"),
    (1202000, 1, 3, "Black Bow of Pharis"),
    (1203000, 1, 1, "Dragonslayer Greatbow"),
    (1204000, 1, 3, "Composite Bow"),
    (1205000, 1, 1, "Darkmoon Bow"),
    (1250000, 1, 4, "Light Crossbow"),
    (1251000, 1, 4, "Heavy Crossbow"),
    (1252000, 1, 4, "Avelyn"),
    (1253000, 1, 4, "Sniper Crossbow"),
    (1300000, 1, 0, "Sorcerer's Catalyst"),
    (1301000, 1, 0, "Beatrice's Catalyst"),
    (1302000, 1, 0, "Tin Banishment Catalyst"),
    (1303000, 1, 0, "Logan's Catalyst"),
    (1304000, 1, 0, "Tin Darkmoon Catalyst"),
    (1305000, 1, 0, "Oolacile Ivory Catalyst"),
    (1306000, 1, 0, "Tin Crystallization Catalyst"),
    (1307000, 1, 0, "Demon's Catalyst"),
    (1308000, 1, 0, "Izalith Catalyst"),
    (1330000, 1, 5, "Pyromancy Flame"),
    (1332000, 1, 6, "Pyromancy Flame (Ascended)"),
    (1360000, 1, 0, "Talisman"),
    (1361000, 1, 0, "Canvas Talisman"),
    (1362000, 1, 0, "Thorolund Talisman"),
    (1363000, 1, 0, "Ivory Talisman"),
    (1365000, 1, 0, "Sunlight Talisman"),
    (1366000, 1, 0, "Darkmoon Talisman"),
    (1367000, 1, 0, "Velka's Talisman"),
    (1396000, 1, 0, "Skull Lantern"),
    (1400000, 1, 4, "East-West Shield"),
    (1401000, 1, 4, "Wooden Shield"),
    (1402000, 1, 4, "Large Leather Shield"),
    (1403000, 1, 4, "Small Leather Shield"),
    (1404000, 1, 4, "Target Shield"),
    (1405000, 1, 4, "Buckler"),
    (1406000, 1, 4, "Cracked Round Shield"),
    (1408000, 1, 4, "Leather Shield"),
    (1409000, 1, 4, "Plank Shield"),
    (1410000, 1, 4, "Caduceus Round Shield"),
    (1411000, 1, 1, "Crystal Ring Shield"),
    (1450000, 1, 4, "Heater Shield"),
    (1451000, 1, 4, "Knight Shield"),
    (1452000, 1, 4, "Tower Kite Shield"),
    (1453000, 1, 4, "Grass Crest Shield"),
    (1454000, 1, 4, "Hollow Soldier Shield"),
    (1455000, 1, 4, "Balder Shield"),
    (1456000, 1, 1, "Crest Shield"),
    (1457000, 1, 1, "Dragon Crest Shield"),
    (1460000, 1, 4, "Warrior's Round Shield"),
    (1461000, 1, 4, "Iron Round Shield"),
    (1462000, 1, 4, "Spider Shield"),
    (1470000, 1, 4, "Spiked Shield"),
    (1471000, 1, 0, "Crystal Shield"),
    (1472000, 1, 4, "Sunlight Shield"),
    (1473000, 1, 1, "Silver Knight Shield"),
    (1474000, 1, 1, "Black Knight Shield"),
    (1475000, 1, 4, "Pierce Shield"),
    (1476000, 1, 4, "Red and White Round Shield"),
    (1477000, 1, 4, "Caduceus Kite Shield"),
    (1478000, 1, 4, "Gargoyle's Shield"),
    (1500000, 1, 4, "Eagle Shield"),
    (1501000, 1, 4, "Tower Shield"),
    (1502000, 1, 4, "Giant Shield"),
    (1503000, 1, 1, "Stone Greatshield"),
    (1505000, 1, 1, "Havel's Greatshield"),
    (1506000, 1, 4, "Bonewheel Shield"),
    (1507000, 1, 1, "Greatshield of Artorias"),
    (1600000, 1, 3, "Whip"),
    (1601000, 1, 3, "Notched Whip"),
    (2000000, 999, 0, "Arrow - Standard"),
    (2001000, 999, 0, "Arrow - Large"),
    (2002000, 999, 0, "Arrow - Feather"),
    (2003000, 999, 0, "Arrow - Fire"),
    (2004000, 999, 0, "Arrow - Poison"),
    (2005000, 999, 0, "Arrow - Moonlight"),
    (2006000, 999, 0, "Arrow - Wooden"),
    (2007000, 999, 0, "Great Arrow - Dragonslayer"),
    (2008000, 999, 0, "Great Arrow - Gough's"),
    (2100000, 999, 0, "Bolt - Standard"),
    (2101000, 999, 0, "Bolt - Heavy"),
    (2102000, 999, 0, "Bolt - Sniper"),
    (2103000, 999, 0, "Bolt - Wood"),
    (2104000, 999, 0, "Bolt - Lightning"),
    (9000000, 1, 4, "Effigy Shield"),
    (9001000, 1, 4, "Sanctus"),
    (9002000, 1, 4, "Bloodshield"),
    (9003000, 1, 4, "Black Iron Greatshield"),
    (9010000, 1, 1, "Gold Tracer"),
    (9011000, 1, 1, "Dark Silver Tracer"),
    (9012000, 1, 1, "Abyss Greatsword"),
    (9014000, 1, 1, "Cleansing Greatshield"),
    (9015000, 1, 1, "Stone Greataxe"),
    (9016000, 1, 3, "Four-pronged Plow"),
    (9017000, 1, 0, "Manus Catalyst"),
    (9018000, 1, 0, "Oolacile Catalyst"),
    (9019000, 1, 3, "Guardian Tail"),
    (9020000, 1, 1, "Obsidian Greatsword"),
    (9021000, 1, 1, "Gough's Greatbow"),
];

const ITEM_DATA: &[(i32, i32, i32, &str)] = &[
    (100, 1, 0, "White Sign Soapstone"),
    (101, 1, 0, "Red Sign Soapstone"),
    (102, 1, 0, "Red Eye Orb"),
    (103, 1, 0, "Black Separation Crystal"),
    (106, 1, 0, "Orange Guidance Soapstone"),
    (108, 1, 0, "Book of the Guilty"),
    (109, 99, 0, "Eye of Death"),
    (111, 99, 0, "Cracked Red Eye Orb"),
    (112, 1, 0, "Servant Roster"),
    (113, 1, 0, "Blue Eye Orb"),
    (114, 1, 0, "Dragon Eye"),
    (115, 1, 0, "Black Eye Orb"),
    (116, 1, 0, "Black Eye Orb (Shiva)"),
    (117, 1, 0, "Darksign"),
    (118, 1, 0, "Purple Coward's Crystal"),
    (200, 1, 0, "Estus Flask (Empty)"),
    (201, 20, 0, "Estus Flask"),
    (202, 1, 0, "Estus Flask+1 (Empty)"),
    (203, 20, 0, "Estus Flask+1"),
    (204, 1, 0, "Estus Flask+2 (Empty)"),
    (205, 20, 0, "Estus Flask+2"),
    (206, 1, 0, "Estus Flask+3 (Empty)"),
    (207, 20, 0, "Estus Flask+3"),
    (208, 1, 0, "Estus Flask+4 (Empty)"),
    (209, 20, 0, "Estus Flask+4"),
    (210, 1, 0, "Estus Flask+5 (Empty)"),
    (211, 20, 0, "Estus Flask+5"),
    (212, 1, 0, "Estus Flask+6 (Empty)"),
    (213, 20, 0, "Estus Flask+6"),
    (214, 1, 0, "Estus Flask+7 (Empty)"),
    (215, 20, 0, "Estus Flask+7"),
    (220, 99, 0, "Silver Pendant"),
    (230, 99, 0, "Elizabeth's Mushroom"),
    (240, 99, 0, "Divine Blessing"),
    (260, 99, 0, "Green Blossom"),
    (270, 99, 0, "Bloodred Moss Clump"),
    (271, 99, 0, "Purple Moss Clump"),
    (272, 99, 0, "Blooming Purple Moss Clump"),
    (274, 99, 0, "Purging Stone"),
    (275, 99, 0, "Egg Vermifuge"),
    (280, 99, 0, "Repair Powder"),
    (290, 99, 0, "Throwing Knife"),
    (291, 99, 0, "Poison Throwing Knife"),
    (292, 99, 0, "Firebomb"),
    (293, 99, 0, "Dung Pie"),
    (294, 99, 0, "Alluring Skull"),
    (296, 99, 0, "Lloyd's Talisman"),
    (297, 99, 0, "Black Firebomb"),
    (310, 99, 0, "Charcoal Pine Resin"),
    (311, 99, 0, "Gold Pine Resin"),
    (312, 99, 0, "Transient Curse"),
    (313, 99, 0, "Rotten Pine Resin"),
    (330, 99, 0, "Homeward Bone"),
    (350, 99, 0, "Humanity"),
    (370, 99, 0, "Prism Stone"),
    (371, 1, 0, "Binoculars"),
    (373, 99, 0, "Indictment"),
    (374, 99, 0, "Souvenir of Reprisal"),
    (375, 99, 0, "Sunlight Medal"),
    (376, 99, 0, "Pendant"),
    (377, 99, 0, "Dragon Head Stone"),
    (378, 99, 0, "Dragon Torso Stone"),
    (380, 99, 0, "Rubbish"),
    (381, 99, 0, "Copper Coin"),
    (382, 99, 0, "Silver Coin"),
    (383, 99, 0, "Gold Coin"),
    (384, 1, 0, "Peculiar Doll"),
    (385, 1, 0, "Dried Finger"),
    (390, 1, 0, "Fire Keeper Soul (Anastacia of Astora)"),
    (391, 1, 0, "Fire Keeper Soul (Darkmoon Knightess)"),
    (392, 1, 0, "Fire Keeper Soul (Daughter of Chaos)"),
    (393, 1, 0, "Fire Keeper Soul (New Londo)"),
    (394, 1, 0, "Fire Keeper Soul (Blighttown)"),
    (395, 1, 0, "Fire Keeper Soul (Duke's Archives)"),
    (396, 1, 0, "Fire Keeper Soul (Undead Parish)"),
    (400, 99, 0, "Soul of a Lost Undead"),
    (401, 99, 0, "Large Soul of a Lost Undead"),
    (402, 99, 0, "Soul of a Nameless Soldier"),
    (403, 99, 0, "Large Soul of a Nameless Soldier"),
    (404, 99, 0, "Soul of a Proud Knight"),
    (405, 99, 0, "Large Soul of a Proud Knight"),
    (406, 99, 0, "Soul of a Brave Warrior"),
    (407, 99, 0, "Large Soul of a Brave Warrior"),
    (408, 99, 0, "Soul of a Hero"),
    (409, 99, 0, "Soul of a Great Hero"),
    (500, 99, 0, "Humanity"),
    (501, 99, 0, "Twin Humanities"),
    (510, 1, 0, "Hello Carving"),
    (511, 1, 0, "Thank you Carving"),
    (512, 1, 0, "Very good! Carving"),
    (513, 1, 0, "I'm sorry Carving"),
    (514, 1, 0, "Help me! Carving"),
    (700, 99, 0, "Soul of Quelaag"),
    (701, 99, 0, "Soul of Sif"),
    (702, 99, 0, "Soul of Gwyn, Lord of Cinder"),
    (703, 99, 0, "Core of an Iron Golem"),
    (704, 99, 0, "Soul of Ornstein"),
    (705, 99, 0, "Soul of the Moonlight Butterfly"),
    (706, 99, 0, "Soul of Smough"),
    (707, 99, 0, "Soul of Priscilla"),
    (708, 99, 0, "Soul of Gwyndolin"),
    (709, 99, 0, "Guardian Soul"),
    (710, 99, 0, "Soul of Artorias"),
    (711, 99, 0, "Soul of Manus"),
    (800, 1, 0, "Large Ember"),
    (801, 1, 0, "Very Large Ember"),
    (802, 1, 0, "Crystal Ember"),
    (806, 1, 0, "Large Magic Ember"),
    (807, 1, 0, "Enchanted Ember"),
    (808, 1, 0, "Divine Ember"),
    (809, 1, 0, "Large Divine Ember"),
    (810, 1, 0, "Dark Ember"),
    (812, 1, 0, "Large Flame Ember"),
    (813, 1, 0, "Chaos Flame Ember"),
    (1000, 99, 0, "Titanite Shard"),
    (1010, 99, 0, "Large Titanite Shard"),
    (1020, 99, 0, "Green Titanite Shard"),
    (1030, 99, 0, "Titanite Chunk"),
    (1040, 99, 0, "Blue Titanite Chunk"),
    (1050, 99, 0, "White Titanite Chunk"),
    (1060, 99, 0, "Red Titanite Chunk"),
    (1070, 99, 0, "Titanite Slab"),
    (1080, 99, 0, "Blue Titanite Slab"),
    (1090, 99, 0, "White Titanite Slab"),
    (1100, 99, 0, "Red Titanite Slab"),
    (1110, 99, 0, "Dragon Scale"),
    (1120, 99, 0, "Demon Titanite"),
    (1130, 99, 0, "Twinkling Titanite"),
    (2001, 1, 0, "Basement Key"),
    (2002, 1, 0, "Crest of Artorias"),
    (2003, 1, 0, "Cage Key"),
    (2004, 1, 0, "Archive Tower Cell Key"),
    (2005, 1, 0, "Archive Tower Giant Door Key"),
    (2006, 1, 0, "Archive Tower Giant Cell Key"),
    (2007, 1, 0, "Blighttown Key"),
    (2008, 1, 0, "Key to New Londo Ruins"),
    (2009, 1, 0, "Annex Key"),
    (2010, 1, 0, "Dungeon Cell Key"),
    (2011, 1, 0, "Big Pilgrim's Key"),
    (2012, 1, 0, "Undead Asylum F2 East Key"),
    (2013, 1, 0, "Key to the Seal"),
    (2014, 1, 0, "Key to Depths"),
    (2015, 1, 0, "Lift Chamber Key"),
    (2016, 1, 0, "Undead Asylum F2 West Key"),
    (2017, 1, 0, "Mystery Key"),
    (2018, 1, 0, "Sewer Chamber Key"),
    (2019, 1, 0, "Watchtower Basement Key"),
    (2020, 1, 0, "Archive Prison Extra Key"),
    (2021, 1, 0, "Residence Key"),
    (2022, 1, 0, "Crest Key"),
    (2100, 1, 0, "Master Key"),
    (2200, 1, 0, "Placeholder Key"),
    (2500, 1, 0, "Lord Soul (Nito)"),
    (2501, 1, 0, "Lord Soul (Bed of Chaos)"),
    (2502, 1, 0, "Bequeathed Lord Soul Shard (Four Kings)"),
    (2503, 1, 0, "Bequeathed Lord Soul Shard (Seath)"),
    (2504, 1, 0, "Demon Flame 5"),
    (2510, 1, 0, "Lordvessel"),
    (2520, 1, 0, "Broken Pendant"),
    (2600, 1, 0, "Weapon Smithbox"),
    (2601, 1, 0, "Armor Smithbox"),
    (2602, 1, 0, "Repairbox"),
    (2603, 1, 0, "Blank Scroll"),
    (2604, 1, 0, "Placeholder Key"),
    (2605, 1, 0, "Placeholder Key"),
    (2606, 1, 0, "Placeholder Key"),
    (2607, 1, 0, "Rite of Kindling"),
    (2608, 1, 0, "Bottomless Box"),
    (2609, 1, 0, "Placeholder Key"),
    (3000, 99, 0, "Sorcery: Soul Arrow"),
    (3010, 99, 0, "Sorcery: Great Soul Arrow"),
    (3020, 99, 0, "Sorcery: Heavy Soul Arrow"),
    (3030, 99, 0, "Sorcery: Great Heavy Soul Arrow"),
    (3040, 99, 0, "Sorcery: Homing Soulmass"),
    (3050, 99, 0, "Sorcery: Homing Crystal Soulmass"),
    (3060, 99, 0, "Sorcery: Soul Spear"),
    (3070, 99, 0, "Sorcery: Crystal Soul Spear"),
    (3100, 99, 0, "Sorcery: Magic Weapon"),
    (3110, 99, 0, "Sorcery: Great Magic Weapon"),
    (3120, 99, 0, "Sorcery: Crystal Magic Weapon"),
    (3300, 99, 0, "Sorcery: Magic Shield"),
    (3310, 99, 0, "Sorcery: Strong Magic Shield"),
    (3400, 99, 0, "Sorcery: Hidden Weapon"),
    (3410, 99, 0, "Sorcery: Hidden Body"),
    (3500, 99, 0, "Sorcery: Cast Light"),
    (3510, 99, 0, "Sorcery: Hush"),
    (3520, 99, 0, "Sorcery: Aural Decoy"),
    (3530, 99, 0, "Sorcery: Repair"),
    (3540, 99, 0, "Sorcery: Fall Control"),
    (3550, 99, 0, "Sorcery: Chameleon"),
    (3600, 99, 0, "Sorcery: Resist Curse"),
    (3610, 99, 0, "Sorcery: Remedy"),
    (3700, 99, 0, "Sorcery: White Dragon Breath"),
    (3710, 99, 0, "Sorcery: Dark Orb"),
    (3720, 99, 0, "Sorcery: Dark Bead"),
    (3730, 99, 0, "Sorcery: Dark Fog"),
    (3740, 99, 0, "Sorcery: Pursuers"),
    (4000, 99, 0, "Pyromancy: Fireball"),
    (4010, 99, 0, "Pyromancy: Fire Orb"),
    (4020, 99, 0, "Pyromancy: Great Fireball"),
    (4030, 99, 0, "Pyromancy: Firestorm"),
    (4040, 99, 0, "Pyromancy: Fire Tempest"),
    (4050, 99, 0, "Pyromancy: Fire Surge"),
    (4060, 99, 0, "Pyromancy: Fire Whip"),
    (4100, 99, 0, "Pyromancy: Combustion"),
    (4110, 99, 0, "Pyromancy: Great Combustion"),
    (4200, 99, 0, "Pyromancy: Poison Mist"),
    (4210, 99, 0, "Pyromancy: Toxic Mist"),
    (4220, 99, 0, "Pyromancy: Acid Surge"),
    (4300, 99, 0, "Pyromancy: Iron Flesh"),
    (4310, 99, 0, "Pyromancy: Flash Sweat"),
    (4360, 99, 0, "Pyromancy: Undead Rapport"),
    (4400, 99, 0, "Pyromancy: Power Within"),
    (4500, 99, 0, "Pyromancy: Great Chaos Fireball"),
    (4510, 99, 0, "Pyromancy: Chaos Storm"),
    (4520, 99, 0, "Pyromancy: Chaos Fire Whip"),
    (4530, 99, 0, "Pyromancy: Black Flame"),
    (5000, 99, 0, "Miracle: Heal"),
    (5010, 99, 0, "Miracle: Great Heal"),
    (5020, 99, 0, "Miracle: Great Heal Excerpt"),
    (5030, 99, 0, "Miracle: Soothing Sunlight"),
    (5040, 99, 0, "Miracle: Replenishment"),
    (5050, 99, 0, "Miracle: Bountiful Sunlight"),
    (5100, 99, 0, "Miracle: Gravelord Sword Dance"),
    (5110, 99, 0, "Miracle: Gravelord Greatsword Dance"),
    (5200, 99, 0, "Miracle: Escape Death"),
    (5210, 99, 0, "Miracle: Homeward"),
    (5300, 99, 0, "Miracle: Force"),
    (5310, 99, 0, "Miracle: Wrath of the Gods"),
    (5320, 99, 0, "Miracle: Emit Force"),
    (5400, 99, 0, "Miracle: Seek Guidance"),
    (5500, 99, 0, "Miracle: Lightning Spear"),
    (5510, 99, 0, "Miracle: Great Lightning Spear"),
    (5520, 99, 0, "Miracle: Sunlight Spear"),
    (5600, 99, 0, "Miracle: Magic Barrier"),
    (5610, 99, 0, "Miracle: Great Magic Barrier"),
    (5700, 99, 0, "Miracle: Karmic Justice"),
    (5800, 99, 0, "Miracle: Tranquil Walk of Peace"),
    (5810, 99, 0, "Miracle: Vow of Silence"),
    (5900, 99, 0, "Miracle: Sunlight Blade"),
    (5910, 99, 0, "Miracle: Darkmoon Blade"),
    (9000, 1, 0, "Beckon"),
    (9001, 1, 0, "Point forward"),
    (9002, 1, 0, "Hurrah!"),
    (9003, 1, 0, "Bow"),
    (9004, 1, 0, "Joy"),
    (9005, 1, 0, "Shrug"),
    (9006, 1, 0, "Wave"),
    (9007, 1, 0, "Praise the Sun"),
    (9008, 1, 0, "Point up"),
    (9009, 1, 0, "Point down"),
    (9010, 1, 0, "Look skyward"),
    (9011, 1, 0, "Well! What is it!"),
    (9012, 1, 0, "Prostration"),
    (9013, 1, 0, "Proper bow"),
    (9014, 1, 0, "Prayer"),
];

pub const ITEMS_CATEGORY: i32 = 0x40000000;

impl Items {
    pub fn new() -> Self {
        Items
    }

    pub fn get_item_data() -> &'static [(i32, i32, i32, &'static str)] {
        ITEM_DATA
    }

    pub fn get_ring_data() -> &'static [(i32, i32, i32, &'static str)] {
        RING_DATA
    }

    pub fn get_weapon_data() -> &'static [(i32, i32, i32, &'static str)] {
        WEAPON_DATA
    }

    pub fn get_infusion_data() -> &'static [(&'static str, i32, i32, bool)] {
        INFUSION_DATA
    }

    pub fn get_item(
        category: i32,
        item_id: i32,
        item_count: i32,
    ) -> Option<(&'static str, i32, i32, i32)> {
        //Checking item category to see which tupple to loop
        if category == ITEMS_CATEGORY {
            for &(id, max_count, _, name) in ITEM_DATA.iter() {
                if id == item_id {
                    let count = if item_count > max_count {
                        max_count
                    } else {
                        item_count
                    };
                    return Some((name, id, count, category));
                }
            }
            return None;
        }
        None
    }

    pub fn execute_get_item(
        &mut self,
        ds1: &mut Ds1,
        category: i32,
        item_id: i32,
        item_count: i32,
    ) {
        let get_item_base_address = ds1.item_get_pointer.base_address;
        
        // Read the resolved address by following chr_data_2 pointer chain, then add inventory offset
        // This reads from the base with no offset (returns the resolved pointer value)
        let chr_data_2_resolved = ds1.chr_data_2.read_i32_rel(None) as usize;
        let inventory_context = (chr_data_2_resolved + CharData2::INVENTORY_INDEX_START) as i32;

        println!("Chardata2 resolved address: {:#x}", chr_data_2_resolved);
        println!("Inventory context (resolved + offset): {:#x}", inventory_context);
        println!("Get item base address: {:#x}", get_item_base_address);
        println!(
            "Giving item ID: {}, Category: {:#x}, Count: {}",
            item_id, category, item_count
        );

        let item_func: ItemFunc = unsafe { mem::transmute(get_item_base_address) };
        item_func(inventory_context, category, item_id, item_count, 1, 0);

        
    }

    
}
